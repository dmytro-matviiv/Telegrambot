# –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –ø–æ–≤—ñ—Ç—Ä—è–Ω–∏—Ö —Ç—Ä–∏–≤–æ–≥

## –ü—Ä–æ–±–ª–µ–º–∞
–°–∏—Å—Ç–µ–º–∞ –Ω–∞–¥—Å–∏–ª–∞–ª–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ—á–∞—Ç–æ–∫ –ø–æ–≤—ñ—Ç—Ä—è–Ω–æ—ó —Ç—Ä–∏–≤–æ–≥–∏, –∞–ª–µ **–ù–ï –Ω–∞–¥—Å–∏–ª–∞–ª–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –≤—ñ–¥–±—ñ–π —Ç—Ä–∏–≤–æ–≥–∏** (–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ç—Ä–∏–≤–æ–≥–∏).

## –ü—Ä–∏—á–∏–Ω–∏ –ø—Ä–æ–±–ª–µ–º–∏

### 1. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ –ª–æ–≥—ñ–∫–∞ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—Ö —Ç—Ä–∏–≤–æ–≥
- –ö–æ–¥ –≤—ñ–¥—Å—Ç–µ–∂—É–≤–∞–≤ —Ç—ñ–ª—å–∫–∏ **–∞–∫—Ç–∏–≤–Ω—ñ** —Ç—Ä–∏–≤–æ–≥–∏ (–±–µ–∑ `finished_at`) –≤ `current_alerts_dict`
- –ü—Ä–∏ –ø–æ—à—É–∫—É –∑–∞–≤–µ—Ä—à–µ–Ω–∏—Ö —Ç—Ä–∏–≤–æ–≥ –Ω–∞–º–∞–≥–∞–≤—Å—è –∑–Ω–∞–π—Ç–∏ —Ç—Ä–∏–≤–æ–≥–∏ –∑ `finished_at` –≤ API –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
- API –º–æ–∂–µ –Ω–µ –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω—ñ —Ç—Ä–∏–≤–æ–≥–∏ –≤ –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –∑–∞–ø–∏—Ç–∞—Ö

### 2. –û–±–º–µ–∂–µ–Ω–µ –≤—ñ–∫–Ω–æ —á–∞—Å—É –¥–ª—è –≤—ñ–¥–±–æ—ó–≤
- –í—ñ–¥–±–æ—ó –Ω–∞–¥—Å–∏–ª–∞–ª–∏—Å—è —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—è –Ω–µ –±—ñ–ª—å—à–µ 2 —Ö–≤–∏–ª–∏–Ω —Ç–æ–º—É
- –¶–µ –±—É–ª–æ –∑–∞–Ω–∞–¥—Ç–æ –æ–±–º–µ–∂—É–≤–∞–ª—å–Ω–æ

## –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è

### 1. –ü–æ–∫—Ä–∞—â–µ–Ω–∞ –ª–æ–≥—ñ–∫–∞ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è —Ç—Ä–∏–≤–æ–≥
```python
# –î–æ–¥–∞–Ω–æ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ç—Ä–∏–≤–æ–≥ (–≤–∫–ª—é—á–Ω–æ –∑ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–º–∏)
all_alerts_dict = {}  # –í—Å—ñ —Ç—Ä–∏–≤–æ–≥–∏ (–≤–∫–ª—é—á–Ω–æ –∑ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–º–∏)
current_alerts_dict = {}  # –¢—ñ–ª—å–∫–∏ –∞–∫—Ç–∏–≤–Ω—ñ —Ç—Ä–∏–≤–æ–≥–∏

for alert in alerts_list:
    # ... –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤–∞–ª—ñ–¥–Ω–æ—Å—Ç—ñ ...
    key = (location_title, alert_type)
    all_alerts_dict[key] = alert  # –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –≤—Å—ñ —Ç—Ä–∏–≤–æ–≥–∏
    
    # –¢—ñ–ª—å–∫–∏ –∞–∫—Ç–∏–≤–Ω—ñ —Ç—Ä–∏–≤–æ–≥–∏
    if location_title and not finished_at:
        current_alerts_dict[key] = alert
```

### 2. –ü–æ–∫—Ä–∞—â–µ–Ω–∞ –ª–æ–≥—ñ–∫–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—Ö —Ç—Ä–∏–≤–æ–≥
```python
# –î–ª—è –∫–æ–∂–Ω–æ—ó –∑–∞–≤–µ—Ä—à–µ–Ω–æ—ó —Ç—Ä–∏–≤–æ–≥–∏
for key in ended_alerts:
    location, alert_type = key
    
    # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ —î –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —Ç—Ä–∏–≤–æ–≥–∞ –≤ API
    finished_alert = all_alerts_dict.get(key)
    if finished_alert and finished_alert.get('finished_at'):
        # –Ñ –≤ API –∑ finished_at - –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∞—Å
        # –ó–±—ñ–ª—å—à–µ–Ω–æ –≤—ñ–∫–Ω–æ –¥–æ 5 —Ö–≤–∏–ª–∏–Ω
        if delta > 5:
            continue
    else:
        # –ù–µ–º–∞—î –≤ API - —Ç—Ä–∏–≤–æ–≥–∞ –ø—Ä–æ—Å—Ç–æ –∑–Ω–∏–∫–ª–∞ –∑ –∞–∫—Ç–∏–≤–Ω–∏—Ö
        # –¶–µ –æ–∑–Ω–∞—á–∞—î –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è, –Ω–∞–¥—Å–∏–ª–∞—î–º–æ –≤—ñ–¥–±—ñ–π
        pass
    
    # –ù–∞–¥—Å–∏–ª–∞—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –≤—ñ–¥–±—ñ–π
    await self.send_alert(text)
```

### 3. –ó–±—ñ–ª—å—à–µ–Ω–æ –≤—ñ–∫–Ω–æ —á–∞—Å—É
- –ó–º—ñ–Ω–µ–Ω–æ –∑ 2 —Ö–≤–∏–ª–∏–Ω –Ω–∞ **5 —Ö–≤–∏–ª–∏–Ω** –¥–ª—è –≤—ñ–¥–±–æ—ó–≤
- –¶–µ –¥–∞—î –±—ñ–ª—å—à–µ —á–∞—Å—É –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—Ö —Ç—Ä–∏–≤–æ–≥

## –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

‚úÖ **–¢–µ—Å—Ç –ø—Ä–æ–π—à–æ–≤ —É—Å–ø—ñ—à–Ω–æ!**

```
[SUCCESS] –¢–ï–°–¢ –ü–†–û–ô–®–û–í –£–°–ü–Ü–®–ù–û! –û–±–∏–¥–≤–∞ —Ç–∏–ø–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –ø—Ä–∞—Ü—é—é—Ç—å.

–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:
1. üö® –ü–æ–≤—ñ—Ç—Ä—è–Ω–∞ —Ç—Ä–∏–≤–æ–≥–∞ ‚Äî –ö–∏—ó–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å
2. ‚úÖ –í—ñ–¥–±—ñ–π —Ç—Ä–∏–≤–æ–≥–∏ ‚Äî –ö–∏—ó–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å

[OK] –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ—á–∞—Ç–æ–∫ —Ç—Ä–∏–≤–æ–≥–∏: –¢–∞–∫
[OK] –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –≤—ñ–¥–±—ñ–π —Ç—Ä–∏–≤–æ–≥–∏: –¢–∞–∫
[OK] API –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: –ü—Ä–∞—Ü—é—î
```

## –§–∞–π–ª–∏ –∑–º—ñ–Ω–µ–Ω–æ

### [`air_alerts_monitor.py`](air_alerts_monitor.py:149)
- **–†—è–¥–∫–∏ 149-168**: –î–æ–¥–∞–Ω–æ `all_alerts_dict` –¥–ª—è –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ç—Ä–∏–≤–æ–≥
- **–†—è–¥–∫–∏ 223-252**: –ü–æ–∫—Ä–∞—â–µ–Ω–∞ –ª–æ–≥—ñ–∫–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—Ö —Ç—Ä–∏–≤–æ–≥
- **–†—è–¥–æ–∫ 242**: –ó–±—ñ–ª—å—à–µ–Ω–æ –≤—ñ–∫–Ω–æ —á–∞—Å—É –∑ 2 –¥–æ 5 —Ö–≤–∏–ª–∏–Ω

### [`test_alerts_fixed.py`](test_alerts_fixed.py:1) (–Ω–æ–≤–∏–π —Ñ–∞–π–ª)
- –°—Ç–≤–æ—Ä–µ–Ω–æ —Ç–µ—Å—Ç–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ª–æ–≥—ñ–∫–∏
- –°–∏–º—É–ª—é—î –ø–æ—á–∞—Ç–æ–∫ —ñ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ç—Ä–∏–≤–æ–≥
- –ü–µ—Ä–µ–≤—ñ—Ä—è—î —Ä–µ–∞–ª—å–Ω–µ API –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è

## –Ø–∫ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–µ—Å—Ç

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç—É –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é Unicode
python -X utf8 test_alerts_fixed.py
```

## –í–∏—Å–Ω–æ–≤–æ–∫

üéâ **–ü—Ä–æ–±–ª–µ–º–∞ –≤–∏—Ä—ñ—à–µ–Ω–∞!** –¢–µ–ø–µ—Ä —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–¥—Å–∏–ª–∞—î:
- ‚úÖ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ **–ø–æ—á–∞—Ç–æ–∫** –ø–æ–≤—ñ—Ç—Ä—è–Ω–æ—ó —Ç—Ä–∏–≤–æ–≥–∏
- ‚úÖ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ **–≤—ñ–¥–±—ñ–π** –ø–æ–≤—ñ—Ç—Ä—è–Ω–æ—ó —Ç—Ä–∏–≤–æ–≥–∏

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —ñ –±—É–¥–µ –∫–æ—Ä–µ–∫—Ç–Ω–æ —ñ–Ω—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –ø—Ä–æ –≤—Å—ñ –∑–º—ñ–Ω–∏ —Å—Ç–∞—Ç—É—Å—É —Ç—Ä–∏–≤–æ–≥.